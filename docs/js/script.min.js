const regEmail=/^((([0-9A-Za-z]{1}[-0-9A-z\.]{0,30}[0-9A-Za-z]?)|([0-9А-Яа-я]{1}[-0-9А-я\.]{0,30}[0-9А-Яа-я]?))@([-A-Za-z]{1,}\.){1,}[-A-Za-z]{2,})$/,regName=/^(?=.{1,35}$)[А-Яа-яё][А-Яа-яё]*(?: [А-Яа-яё]+)*$/,userName=document.querySelector("#user-name"),userPhone=document.querySelector("#user-phone"),userEmail=document.querySelector("#user-email"),formBtn=document.querySelector(".form__button"),form=document.querySelector("#form");function validInput(e){parent=e.closest(".form-field"),blockError=parent.querySelector(".form-field__error-mess"),e.classList.add("valid"),e.classList.remove("invalid"),blockError.textContent=""}function inValidInput(e,t){parent=e.closest(".form-field"),blockError=parent.querySelector(".form-field__error-mess"),e.classList.remove("valid"),e.classList.add("invalid"),blockError.textContent=t}function regexValidite(e,t){return t.test(e)}function verification(e,t,r){if(regexValidite(e.value,t)){if(!(e.value.length<=5))return validInput(e),!0;inValidInput(e,"Заполните поле.")}else inValidInput(e,r),""===e.value&&(blockError.textContent="Заполните поле.")}let valueName="",valuePhone="",valueMail="";function getInputNumbersValue(e){return e.value.replace(/\D/g,"")}function onPhoneInput(e){let t=e.target,r=getInputNumbersValue(t),n="",a=t.selectionStart;if(t.value.length<=17?inValidInput(t,"Номеер не найден."):validInput(t),!r)return t.value="";if(t.value.length==a){if(["7","8","9"].indexOf(r[0])>-1){"9"==r[0]&&(r="7"+r),n=("8"==r[0]?"8 ":"+7")+" ",r.length>1&&(n+="("+r.substring(1,4)),r.length>=5&&(n+=") "+r.substring(4,7)),r.length>=8&&(n+="-"+r.substring(7,9)),r.length>=10&&(n+="-"+r.substring(9,11))}else n="+"+r;t.value=n}else e.data&&/\D/g.test(e.data)&&(t.value=r)}function onPhoneKeyDown(e){let t=e.target;8==e.keyCode&&1==getInputNumbersValue(t).length&&(t.value="",parent=t.closest(".form-field"),blockError=parent.querySelector(".form-field__error-mess"),t.classList.remove("valid"),t.classList.add("invalid"),blockError.textContent="Заполните поле.")}function onPhonePaste(e){let t=e.clipboardData||window.clipboardData,r=e.target,n=getInputNumbersValue(r);if(t){let e=t.getData("Text");/\D/g.test(e)&&(r.value=n)}}function verSub(...e){e.every((e=>e.classList.contains("valid")))?formBtn.classList.add("active"):formBtn.classList.remove("active")}userName.addEventListener("input",(()=>{valueName=verification(userName,regName,"Проверьте поле на правильность заполения.")})),userEmail.addEventListener("input",(()=>{valueMail=verification(userEmail,regEmail,"Почта не найдена.")})),userPhone.addEventListener("input",onPhoneInput),userPhone.addEventListener("keydown",onPhoneKeyDown),userPhone.addEventListener("paste",onPhonePaste),form.addEventListener("input",(()=>{verSub(userName,userEmail,userPhone)})),form.addEventListener("submit",(e=>{if(e.preventDefault(),valueName&&valueMail&&valuePhone){const e=document.querySelector(".popup"),t=document.querySelector(".popup__close-btn"),r=document.querySelector("#contract"),n=document.querySelectorAll("input");e.classList.add("popup_open"),t.addEventListener("click",(()=>{e.classList.remove("popup_open")})),n.forEach((e=>{e.value="",e.classList.remove("valid")})),formBtn.classList.remove("active"),r.checked=!1}else alert("Проверьте все поля на правильность заполения.")}));